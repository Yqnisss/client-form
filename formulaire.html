<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire d'Inscription</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">Formulaire d'Inscription</h1>
        <form id="inscriptionForm">
            <div class="mb-3">
                <label for="nom" class="form-label">Nom</label>
                <input type="text" class="form-control" id="nom" required>
            </div>
            <div class="mb-3">
                <label for="prenom" class="form-label">Prénom</label>
                <input type="text" class="form-control" id="prenom" required>
            </div>
            <div class="mb-3">
                <label for="nin" class="form-label">NIN</label>
                <input type="text" class="form-control" id="nin" required>
            </div>
            <div class="mb-3">
                <label for="adresse" class="form-label">Adresse</label>
                <input type="text" class="form-control" id="adresse" required>
            </div>
            <div class="mb-3">
                <label for="telephone" class="form-label">Numéro de téléphone</label>
                <input type="tel" class="form-control" id="telephone" required>
            </div>
            <div class="mb-3">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control" id="email" required>
            </div>
            <button type="submit" class="btn btn-primary">Enregistrer</button>
        </form>
        <button id="exportButton" class="btn btn-success mt-3">Exporter en Excel</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script>
        // Enregistrer les clients dans le localStorage
        document.getElementById('inscriptionForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const client = {
                nom: document.getElementById('nom').value,
                prenom: document.getElementById('prenom').value,
                nin: document.getElementById('nin').value,
                adresse: document.getElementById('adresse').value,
                telephone: document.getElementById('telephone').value,
                email: document.getElementById('email').value
            };

            let clients = JSON.parse(localStorage.getItem('clients')) || [];
            clients.push(client);
            localStorage.setItem('clients', JSON.stringify(clients));

            alert('Client enregistré avec succès !');
            document.getElementById('inscriptionForm').reset(); // Réinitialiser le formulaire
        });

        // Exporter les données en Excel
        document.getElementById('exportButton').addEventListener('click', function() {
            const clients = JSON.parse(localStorage.getItem('clients')) || [];

            if (clients.length === 0) {
                alert('Aucun client à exporter.');
                return;
            }

            // Convertir les données en format Excel
            const wsData = clients.map(client => [
                client.nom,
                client.prenom,
                client.nin,
                client.adresse,
                client.telephone,
                client.email
            ]);

            const ws = XLSX.utils.aoa_to_sheet([['Nom', 'Prénom', 'NIN', 'Adresse', 'Numéro de téléphone', 'Email'], ...wsData]);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Clients');
            XLSX.writeFile(wb, 'clients.xlsx');
        });
    </script>
</body>
</html>
